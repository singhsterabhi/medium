$(document).ready(function(){function on_key_down(){window.location=nextroomurl;return false;}
$(document).bind('keydown','ctrl+/',on_key_down);$(document).bind('keydown','command+/',on_key_down);});var nextroom_scan={_start_time:null,_scan_timeout:null,_update_timeout:null,_trigger_timeout:null,_is_alive:false,_max_scanning_seconds:30*60,start:function(seconds_p){var seconds=parseInt(seconds_p);if(isNaN(seconds)){return;}
if(seconds<2){seconds=2;}
nextroom_scan._scan_timeout=seconds;nextroom_scan._start_time=Math.round(new Date()/1000);nextroom_scan._trigger_timeout=setTimeout(nextroom_scan.trigger,1000*seconds);nextroom_scan._update_timeout=setInterval(nextroom_scan.update,1000);nextroom_scan._is_alive=true;$(document).bind('keydown',function(){if(nextroom_scan._is_alive){nextroom_scan.stop();return false;}
return true;});$("a.exitscanning").bind("click",nextroom_scan.stop);},stop:function(){clearInterval(nextroom_scan._trigger_timeout);clearInterval(nextroom_scan._update_timeout);nextroom_scan._is_alive=false;var new_content=$("div.next_cam_template ul.actions").html();$(".top-section ul.actions").html(new_content);return false;},get_timescanning:function(){var time_scanning=$.url().param("time_scanning");if(time_scanning){return parseInt(time_scanning);}
return 0;},get_next_url:function(){var next_in=parseInt($.url().param("next_in"));var time_scanning=nextroom_scan.get_timescanning()+next_in;var next_url=nextroomurl+"?next_in="+
nextroom_scan._scan_timeout;if(time_scanning>nextroom_scan._max_scanning_seconds){next_url=next_url+"&time_scanning="+0;return timeoutscanningurl+"?next_url="+urlencode(next_url);}
next_url=next_url+"&time_scanning="+time_scanning;return next_url;},trigger:function(){window.location=nextroom_scan.get_next_url();},update:function(){$(".auto_next_cam_countdown").text(nextroom_scan.time_left());},time_left:function(){var val=Math.ceil((nextroom_scan._start_time+nextroom_scan._scan_timeout)-
Math.round(new Date()/1000));if(val<0){return 0;}else{return val;}}};