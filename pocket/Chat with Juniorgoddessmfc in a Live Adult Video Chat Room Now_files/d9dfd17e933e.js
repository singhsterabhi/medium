var player=$('#player');var resizable_player={is_in_iframe:window.location!=window.parent.location,width:player.width(),height:player.height(),vbox:$('.video-box'),chat_list:$('.chat-list'),chat_box:$('.chat-box'),chat_holder:$('.chat-holder'),chat_content:$('.content .section'),users_list:$('.users-list'),settings_list:null,duration:3000,widescreen:false,sd_resize_factor:0.75,ws_resize_factor:0.5625,control_bar_height:32,min_chat_width:200,vertical_buffer:166,min_player_width:500,min_player_height:300,player:player,html_video:null,init:function(is_wide,is_html_video){if(this.is_in_iframe){return;}
this.widescreen=typeof is_wide!=='undefined'?is_wide:false;if(typeof is_html_video!=='undefined'?is_html_video:false){this.control_bar_height=0;this.html_video=$('#still_video video');}
var loaded_width=$.cookie('player_width');if(loaded_width){var loaded_height=this.get_height_from_width(loaded_width);this.width=loaded_width;this.height=loaded_height;this.reset_player();}
this.bind();$(window).resize(this.on_window_resize);},get_max_width:function(){return this.vbox.parent().width()-this.min_chat_width;},get_max_height:function(){return $(window).height()-this.vertical_buffer;},get_height_from_width:function(width){return Math.round((parseFloat(width)*(this.widescreen?this.ws_resize_factor:this.sd_resize_factor))+this.control_bar_height);},get_width_from_height:function(height){return Math.round((parseFloat(height)-this.control_bar_height)/(this.widescreen?this.ws_resize_factor:this.sd_resize_factor));},set_resolution_to_max:function(){if(!$.cookie('player_width')){var viewport_width=$(window).width();if(this.get_max_width()>viewport_width/2){this.width=viewport_width/2;this.height=this.get_height_from_width(this.width);}else{this.height=this.get_max_height();this.width=this.get_height_from_width(this.height)}
if(this.height>this.get_max_height()){this.height=this.get_max_height();this.width=this.get_width_from_height(this.height);}
if(this.height<this.min_player_height||this.width<this.min_player_width){this.width=this.min_player_width;this.height=this.get_height_from_width(this.width);}
this.reset_player();}},on_window_resize:function(){setTimeout(function(){var r=resizable_player;var max_width=r.get_max_width();r.player.resizable('option','maxWidth',max_width);if(r.player.width()>max_width){r.player.css('width',max_width+'px');r.player.css('height',Math.round((max_width*(r.widescreen?r.ws_resize_factor:r.sd_resize_factor))+r.control_bar_height)+'px');}else{r.player.css('height',Math.round((r.player.width()*(r.widescreen?r.ws_resize_factor:r.sd_resize_factor))+r.control_bar_height)+'px');}
r.update_sizes();r.chat_list.width(r.chat_box-25);$.mydefchatconn('scroll_to_bottom');},1);},reset_player:function(){this.player.width(this.width);this.player.height(this.height);if(this.html_video){this.html_video.width(this.width);this.html_video.height(this.height);}
this.update_sizes();},update_sizes:function(){this.vbox.width(this.player.width());var h=this.player.height()+109;var h2=this.player.height()+37;this.chat_list.height(this.player.height()+37);this.chat_holder.css('margin-left',this.player.width()+10+'px');this.chat_content.height(h);this.users_list.height(h2);this._get_settings_list().height(h2);this.chat_list.width(this.chat_content.width()-this.vbox.width()-35);},store_sizes:function(){$.cookie('player_width',this.player.width(),{path:'/'});},bind:function(){var alsoResize='.video-box';if(this.html_video){alsoResize+=', #still_video video';}
this.player.resizable({alsoResize:alsoResize,aspectRatio:true,minWidth:this.min_player_width,maxWidth:this.get_max_width(),minHeight:this.min_player_height,resize:function(){resizable_player.update_sizes();},stop:function(){resizable_player.store_sizes();}});},_get_settings_list:function(){return this.settings_list?this.settings_list:$('div.settings-list');}};